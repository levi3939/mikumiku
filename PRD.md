# 通勤时间计算工具 - 产品需求文档

## 一、产品概述

通勤时间计算工具是一个基于网页的应用程序，用户可以上传包含出发地址的表格，并输入目标地址，点击计算按钮后，后台将利用百度地图API计算每个出发地址到目标地址的通勤时间，并将结果保存到新的表格中供用户下载。

## 二、目标用户

需要计算多个地址到目标地址通勤时间的用户，主要是家教中介。

## 三、功能需求

### 1. 前端功能

#### 基础功能组件
- **目标地址输入框**
  - 用户输入目标地址
  - 必填项，缺少时给予提示

- **上传表格按钮**
  - 用户上传包含出发地址的表格
  - 表格格式参考"待处理表格.xlsx"
  - 必填项，缺少时给予提示

- **计算按钮**
  - 点击后开始计算通勤时间
  - 带有点击动效

- **实时进度条**
  - 显示计算进度
  - 总进度为表格行数（不包含表头）
  - 每处理完一行进度加一

- **下载按钮**
  - 用户可下载计算结果表格
  - 格式参考"处理结果.xlsx"

#### 界面要求
- 界面美观，布局合理
- 用户体验良好
- 必填项缺少时给予明确提示

### 2. 后端功能

#### 地理编码功能
- 调用百度地图API将表格中的出发地址转化为经纬度
- 将转换后的经纬度填入表格中

#### 通勤时间计算
根据距离智能选择交通方式：
- 距离 < 5公里：选择骑行方式
- 距离 ≥ 5公里：选择公共交通方式（地铁和公交车）

#### 结果处理
- 将计算结果保存到新表格
- 结果包含：经纬度、通勤时间、交通方式
- 提供下载链接

#### API密钥管理
- 支持配置多个百度地图API密钥
- 自动检测当前密钥剩余额度
- 额度用尽时自动切换到下一个密钥
- 提示用户API额度不足状态

## 四、非功能需求

### 1. 性能需求
- **响应时间**：计算过程应在合理时间内完成（具体时间根据表格大小和API调用情况而定）

### 2. 安全需求
- **文件上传安全**
  - 限制上传文件类型为.xlsx或.xls
  - 防止恶意文件上传
- **数据安全**
  - 保护用户数据安全
  - 不泄露用户上传的表格和计算结果

### 3. 兼容性需求
支持主流浏览器：
- Chrome
- Firefox
- Safari
- Edge

## 五、技术选型

### 前端技术栈
- HTML
- CSS
- JavaScript
- ProgressBar.js（进度条组件）

### 后端技术栈
- **语言**：Python
- **框架**：Flask
- **数据处理**：pandas
- **API调用**：requests

## 六、预期成果

1. 完整的网页应用
   - 支持表格上传
   - 支持通勤时间计算
   - 提供结果下载

2. 计算结果输出
   - 新表格形式
   - 包含完整计算数据

3. API管理功能
   - 多密钥管理
   - 自动切换机制

## 七、其他说明

### 数据处理说明
- 不存储用户上传的表格和计算结果
- 数据仅在服务器内存中临时存储
- 计算完成后立即删除

### 免责说明
- 不保证计算结果的绝对准确性
- 具体以实际通行情况为准 